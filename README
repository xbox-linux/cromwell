CROMWELL 1.6a   2002-12-18
Xbox Linux Team

Contact: andy@warmcat.com, mist@c64.org. xboxlinux@meriac.de

-----------
IMPORTANT... Don't run this code without backing up your EEPROM
contents somehow first.  Its been quite stable, but it if it
blows a fuse and craps over your eeprom, don't blame us.
-----------

Improvements!

 - *NEW* ISO9660 native support in BIOS - If no MBR on HDD, boots from
   Mandrake 9 install CD to install Linux itself
 - *NEW* honours linuxboot.cfg if found in HDD /boot or CD
 - *NEW* extra compile-time options at BootResetAction.c line 24+
 - now capable of booting a Mandrake 9 Linux install by itself
 - VIDEO IS FULLY UP (Composite cable only, PAL) at boottime and
   inside Linux; works with Oliver's accellerated X driver (reserves
	 4MByte of RAM for video)
 - the ROM image is now 256KByte, works with all flashable modchips
 - ** No Microsoft code **  - a legal[1] alternative BIOS
 - auto-unlocks the HDD according to your EEPROM information
 - boots using MBR -> active partition -> reiserfs native loader,
   so it does not use LILO or GRUB, or keep any private HDD space.

LEGAL NOTE 1:

[1]Consult a lawyer if you want legal advice.  But we believe this BIOS
is immune to legal attack by MS as it contains none of their code and
won't even run native games

LEGAL NOTE 2:

This replacement BIOS will be used by most people in a flashable
modchip.  Up to now, MS might have argued that modchips are used
solely to hold hacked native BIOSes and are therefore somehow
illegal (still beats me why that would be, as each Xbox owner is
legitimately licensed to have a BIOS, if they choose to modify it,
just using the original or the modified version at any one time,
surely invalidating their warrenty should be the limit of MS's
comeback).  We would encorage manufacturers of flashable modchips
to ship their mods with this Linux Cromwell BIOS on them,
although probably they'll want to wait another couple of versions
for the next set of features.


Limitations

 - COMPOSITE cable only right now if you want the right colours
 - choice between 640x480 overscan-corrected, or 640x576 with default
    overscan at the moment (see BootResetAction.c line 34)
 - Boot instability has been reported on different machines.  Cause
    not understood, effect is sometimes it may not boot.  Being looked
		at, but its perfectly stable on my machine :-(

ALSO NOTE: this version is for v1.0 boxes only.  The preferred method
of running the BIOS on v1.1 needs the original Xcodes.  We will be
addressing this in the next version, which should not be far off.


How to set up for booting Linux from BIOS on your Xbox
------------------------------------------------------

NOTE 1 - if you go back to a hacked or original BIOS, you will still
be able to boot Linux via CD as before, and play native games.

NOTE 2- do NOT blow this into a BIOS that you have no way of externally
reprogramming.  Reprogramming the BIOS is not yet supported from
within Linux or the bootrom itself.

1) Install the Mandrake 9 distro from http://xbox-linux.sf.net (it
will not currently work with Ed's Debian distro from
http://xbox-debian.linux.pt/ as we currently assume reiserfs).
Note that you can use Cromwell to install this simply by inserting
the installation CD in the drive when asked (if your machine has
no MBR on the hdd already).

2) Copy vmlinuz and initrd from the boot CD to /boot on the HDD.

3) shutdown your linux install

4) flash your modchip with the 256Kbyte file image.bin (this is
also supplied precooked as image.bin.ready-to-use, or you can run
make to generate image.bin)

5) reboot and enjoy the disc whirring while Linux starts


Compile-time options defaults

See BootResetAction.c line 24 onwards

// selects between the supported video modes, both PAL at the moment
#define VIDEO_PREFERRED_LINES 576
//#define VIDEO_PREFERRED_LINES 480

// uncomment to force CD boot mode even if MBR present
// default is to boot from HDD if MBR present, else CD
//#define FORCE_CD_BOOT

// display a line like Composite 480 detected if uncommented
//#define REPORT_VIDEO_MODE

// show the MBR table if the MBR is valid
#define DISPLAY_MBR_INFO

Todo

1) Get USB stack up in BIOS (<-- not looking forward to this)
2) Once we have a UI, allow BIOS flashing
3) Update to Mankdrake 9 installation CD set needed, so it copies
   vmlinuz and initrd to /boot by default
